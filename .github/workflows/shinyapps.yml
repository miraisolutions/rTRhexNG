name: CI

on: [push]

jobs:
  build:

    runs-on: ubuntu-latest
    container:
      image: rstudio/r-base:3.6-bionic

    steps:
    - uses: actions/checkout@v1
    - name: Run a one-line script
      run: echo Hello, world!
    - name: Install System Dependencies
      run: |
        sudo apt-get update && apt-get install -y --no-install-recommends \
        libxml2-dev \
        libssl-dev \
        libcurl4-openssl-dev
    - name: Install Package Dependencies
      run: |-
        R -e "install.packages('rsconnect', 'colourpicker', 'png', 'rTRNG', 'rsvg', 'shiny', repos = 'https://cloud.r-project.org')"
    - name: Run a multi-line script
      env: # Or as an environment variable
        SHINYAPPS_SECRET: ${{ secrets.SHINYAPPS_SECRET }}
      run: |
        Rscript -e "rsconnect::setAccountInfo(name='riccardoporreca', token='2139675380B582458FF0F4AFE10E5626', secret=Sys.getenv('SHINYAPPS_SECRET'))"
        Rscript -e 'rsconnect::deployApp(appPrimaryDoc = "rTRNG-stickR-app.R", account = "riccardoporreca", appName = "rTRhexNG")'
